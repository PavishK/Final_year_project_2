<div class="p-6 max-w-3xl mx-auto">
  <h1 class="text-2xl font-bold text-center mb-4">Manage Coupons</h1>

  <div class="bg-white p-4 rounded-lg shadow-md mb-4">
    <h2 class="text-lg font-semibold mb-2">{{ editMode ? 'Edit Coupon' : 'Add New Coupon' }}</h2>

    <label class="block mb-1 font-medium">Coupon Code</label>
    <input type="text" [(ngModel)]="currentCoupon.coupon_code" class="border p-2 w-full rounded mb-2" maxlength="10" minlength="10" placeholder="Enter coupon code" />

    <label class="block mb-1 font-medium">Expiration Date</label>
    <input type="date" [(ngModel)]="currentCoupon.exp_date" class="border p-2 w-full rounded mb-2" />

    <label class="block mb-1 font-medium">Discount</label>
    <input type="number" [(ngModel)]="currentCoupon.discount" class="border p-2 w-full rounded mb-2" placeholder="Enter discount amount" />

    <label class="block mb-1 font-medium">Max Usage</label>
    <input type="number" [(ngModel)]="currentCoupon.max_use" class="border p-2 w-full rounded mb-2" placeholder="Enter max usage limit" />

    <div class="flex space-x-2 mt-3">
      <button *ngIf="!editMode" class="bg-blue-500 text-white px-4 py-2 rounded w-full" (click)="submitCoupon()">Add</button>
      <button *ngIf="editMode" class="bg-green-500 text-white px-4 py-2 rounded w-full" (click)="submitCoupon()">Update</button>
      <button *ngIf="editMode" class="bg-gray-500 text-white px-4 py-2 rounded w-full" (click)="resetForm()">Cancel</button>
    </div>
  </div>

  <div class="bg-white p-4 rounded-lg shadow-md">
    <h2 class="text-lg font-semibold mb-2">Coupons List</h2>
    <table class="w-full border-collapse">
      <thead>
        <tr class="bg-gray-200">
          <th class="p-2">Code</th>
          <th class="p-2">Expiration</th>
          <th class="p-2">Discount</th>
          <th class="p-2">Max Usage</th>
          <th class="p-2">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let coupon of coupons; let i = index" class="border-t">
          <td class="p-2">{{ coupon.coupon_code }}</td>
          <td class="p-2">{{ coupon.exp_date }}</td>
          <td class="p-2">{{ coupon.discount * 100 }}%</td>
          <td class="p-2">{{ coupon.max_use }}</td>
          <td class="p-2 space-x-2">
            <button class="bg-yellow-500 text-white px-3 py-1 rounded" (click)="editCoupon(i)">Edit</button>
            <button class="bg-red-500 text-white px-3 py-1 rounded" (click)="deleteCoupon(coupon._id)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<app-loading-spinner [isLoading]="loading"></app-loading-spinner>
